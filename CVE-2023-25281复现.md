# CVE-2023-25281复现

这是D-Link路由器的一个栈溢出漏洞，比较简单的洞，但从中也能学习到许多挖洞的思路。

首先，栈溢出漏洞通常是由危险函数导致的。我们明确了要挖栈溢出漏洞后，就需要去前端找一些输入点，然后从输入点确定之后的函数是不是危险函数（比如scanf、get、strcpy）。有危险函数就看看附件有没有过滤操作，如果没有，漏洞的风险就比较大。

挖在野漏洞通常是考验我们的代码审计功底，基本上很多洞都是审计审出来的。

好了，回到正题。首先，我们需要获取漏洞固件：https://www.dlinktw.com.tw/techsupport/AllPro.aspx，版本为D-link DIR820LA1_FW105B03

然后，在kali里边用binwalk解包，再用FirmAE模拟



如何确定漏洞点？进入192.168.0.1后，跳过设置界面，可以有一个login.asp的登陆页面。默认密码为空，可以直接进。

进去之后可以根据地址栏的函数以及bp抓包获得的参数锁定关键词，然后用grep -Rnl在固件里找相关文件。如果知道D-Link的情况，那应该有听闻它的ncc功能做得挺差的，很多洞都从中来。所以可以优先从这些东西里边找。



锁定了ncc2文件后，ida打开，开始根据刚才锁定的参数找函数。如果从login.asp开始找，那得过一波审计：

![login.asp函数](F:\Target\Step\login.asp函数.png)

向上审计

![login向上审计](F:\Target\Step\login向上审计.png)

然后确定get_entry_value_by_name是一个和post有关的东西。巧了，这个路由器发的挺多包都是post的，那么根据这个找找相关输入参数

![get_entry_value_by_name](F:\Target\Step\get_entry_value_by_name.png)

很多，要慢慢审计。最后确定某个参数接着的是危险函数：

![漏洞代码](F:\Target\Step\漏洞代码.png)

可以看到，如果从ping.c开始做，那么将不会花太多时间在审计上。

最后构造Post包来试试能不能栈溢出

![0408CVE-2023-25281复现](F:\Target\Step\0408CVE-2023-25281复现.png)

路由无响应了，成功攻击



另外，我看了看106版本的固件，同样也存在着相同的漏洞。这说明可以从老版本的固件去发掘漏洞点，然后在新版本做测试来验证。

![106版本依然也存在这个漏洞](F:\Target\Step\106版本依然也存在这个漏洞.png)